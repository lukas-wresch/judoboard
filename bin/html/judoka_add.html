<h1 id="headline">New Judoka</h1>

<form>

<div>
    <label style="width:150px;float:left;margin-top:4px;" id="label_firstname">Given name</label>
    <input style="margin-bottom:20px;" type="text" id="firstname" value="" size="40" maxlength="64"/>
</div>

<div>
    <label style="width:150px;float:left;margin-top:4px;" id="label_lastname">Family name</label>
    <input style="margin-bottom:20px;" type="text" id="lastname" value="" size="40" maxlength="64"/>
</div>

<div>
    <label style="width:150px;float:left;margin-top:4px;" id="label_weight">Weight</label>
    <input style="margin-bottom:20px;" type="text" id="weight" value="" min="10" max="500" />
</div>

<div>
  <label style="width:150px;float:left;margin-top:5px;" id="label_gender">Gender</label>
  <select style="margin-bottom:20px;" id="gender">
    <option selected value="0" id="male">Male</option>
    <option value="1" id="female">Female</option>
  </select>
</div>

<div>
    <label style="width:150px;float:left;margin-top:4px;" id="label_birthyear">Birthyear</label>
    <input style="margin-bottom:20px;" type="number" id="birthyear" value="1995" min="1900" max="2100" />
</div>

<div>
  <label style="width:150px;float:left;margin-top:5px;" id="label_club">Club</label>
  <select style="margin-bottom:20px;" id="clubs">
    <option selected value="1" id="club_none">(None)</option>
  </select>
</div>

<div style="margin-bottom: 1cm;" id="note" style="display: none; font-weight: bold;">
</div>

<button class="add" id="add" onclick="return AddJudoka()">New Judoka</button>
<button class="neutral" style="margin-right: 2cm;" onclick="return UpdateJudoka()" id="update">Save</button>
<button class="remove" onclick="return DeleteJudoka()" id="delete">Delete</button>

</form>


<script>

function AddJudoka()
{
  var params = URLEncode({
    firstname: document.getElementById("firstname").value,
    lastname:  document.getElementById("lastname").value,
    weight:    document.getElementById("weight").value,
    gender:    document.getElementById("gender").value,
    birthyear: document.getElementById("birthyear").value,
    club:      document.getElementById("clubs").value,
  });

  AjaxPost('ajax/judoka/add', params, function() {
    $("#note").text(document.getElementById("firstname").value + " " + document.getElementById("lastname").value + " added to database.");
    $("#note").show(1000).delay(3000).hide(2000);

    document.getElementById("firstname").value = "";
    document.getElementById("lastname").value  = "";
  });

  return false;
}



function GetJudoka(id)
{
  AjaxCallback("ajax/judoka/get?id="+id, function(response) {
    console.log(response);
    var res = YAML.parse(response);

    document.getElementById("firstname").value = res.firstname;
    document.getElementById("lastname").value  = res.lastname;
    document.getElementById("weight").value    = String(res.weight).trim();
    document.getElementById("gender").value    = res.gender;
    document.getElementById("birthyear").value = res.birthyear;

    GetClubs(function(response) {
      if (res.club != null)
        document.getElementById("clubs").value = res.club;
    });
  });
}



function UpdateJudoka()
{
  var params = URLEncode({
    firstname: document.getElementById("firstname").value,
    lastname:  document.getElementById("lastname").value,
    weight:    document.getElementById("weight").value,
    gender:    document.getElementById("gender").value,
    club:      document.getElementById("clubs").value,
  });

  AjaxPost('ajax/judoka/update?id='+id, params, function() {
    navigate('judoka_list.html');
  });

  return false;
}



function DeleteJudoka()
{
  if (confirm(lang.delete_judoka_confirm))
  {
    Ajax('ajax/judoka/delete?id='+id);
    navigate('schedule.html');
  }

  return false;
}



var id = URLDecode(URL, "id");

if (id)
{
    document.getElementById("add").style.display  = "none";
    document.getElementById("headline").innerHTML = lang.edit_judoka;
    GetJudoka(id);
}
else
{
    document.getElementById("headline").innerHTML = lang.new_judoka;
    document.getElementById("update").style.display = "none";
    document.getElementById("delete").style.display = "none";
}


document.getElementById("label_firstname").innerHTML = lang.firstname;
document.getElementById("label_lastname").innerHTML  = lang.lastname;
document.getElementById("label_weight").innerHTML  = lang.weight;
document.getElementById("label_gender").innerHTML  = lang.gender;
document.getElementById("label_club").innerHTML    = lang.club;
document.getElementById("male").innerHTML  = lang.male;
document.getElementById("female").innerHTML  = lang.female;
document.getElementById("add").innerHTML     = lang.new_judoka;

</script>